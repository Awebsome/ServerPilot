<?php if(count($Servers->get())>0):?>
 
<?php foreach($Servers->get() as $server => $value): ?>
    <div class="callout fade in callout-info no-icon no-subheader col-lg-8 col-md-12">
        <div class="header">
            <h3><i class="oc-icon-hdd-o"></i><?=$value->name?></h3>
        </div>
        <div class="content">
            <div class="control-status-list">
                <ul>
                    <?php
                    foreach($value->databases as $database => $db):?>
                        <li>
                            <div class="row">
                                <div class="col-sm-6 col-lg-3" style="margin-top:5px;">
                                    <span class="status-icon info"><i class="icon-database"></i></span>
                                    <span class="status-text info"><?=$db->name?></span>
                                </div>
                                <div class="col-sm-6 col-lg-3" style="margin-top:5px;">
                                    <span class="status-icon default"><i class="icon-puzzle-piece"></i></span>
                                    <span class="status-text info"><?=$db->app->name?></span>
                                </div>
                                <div class="col-sm-6 col-lg-3" style="margin-top:5px;">
                                    <span class="status-icon warning"><i class="icon-user"></i></span>
                                    <span class="status-text warning"><?=$db->user['name']?></span>
                                </div>
                                <div class="col-sm-6 col-lg-3" style="margin-top:5px;" id="reset-<?=$db->id?>">
                                    <span class="status-icon warning"><i class="icon-key"></i></span>
                                    <span class="status-text warning"><span class="password-reset"><b><span class="password">···Password···</span></b></span> 
                                    <button 
                                        type="button"
                                        data-request="onResetPsw"
                                        data-request-confirm="Reset <?=$db->name?> password, are you sure?" 
                                        data-request-data="resource: 'Databases', 
                                                            resource_id: '<?=$db->id?>', 
                                                            user_name: '<?=$db->user['id']?>'" 
                                        data-request-success="jUpdatePassword(data);" 
                                        class="btn btn-warning btn-xs pull-right oc-icon-refresh" 
                                        data-toggle="tooltip" data-placement="right" 
                                        data-delay="500" 
                                        title="Reset Password" 
                                        data-request-loading="#<?=$db->id?>"
                                        style="padding-right: 0;"></button></span>

                                    <div id="<?=$db->id?>" class="loading-indicator-container" style="display:none;">
                                        <div class="loading-indicator size-small">
                                            <span></span>
                                            <div>Reset password...</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </li>
                    <? endforeach ?>
                </ul>
            </div>
        </div>
    </div>
<? endforeach; ?>
<?else:?>
<p class="flash-message static error">No databases to display</p>
<?endif?>
<script>
    function jUpdatePassword(data){
        $('#reset-' + data.resource_id +' .password').text( data.newPassword );
        $('#reset-' + data.resource_id +' .password').addClass( 'text-success' );
        $('#reset-' + data.resource_id +' .btn').hide();
    }
</script>